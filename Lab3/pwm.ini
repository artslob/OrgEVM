/*
include pwm.ini; pwm(100);
include pwm.ini; pwm(10);
*/

SIGNAL void pwm(unsigned long Time) {
	char i;
	P3 = 0x3F;
	twatch(10 * Time);
	while(1) {
		for(i = 0; i < 2; i++){
			P3=0x0F;
			twatch (3 * Time); //0
			P3=0;
			twatch (2 * Time);
			
			P3=0x0F; //1
			twatch (2 * Time);
			P3=0;
			twatch (3 * Time);
			
			P3=0x0F; //1
			twatch (2 * Time);
			P3=0;
			twatch (3 * Time);
			
			P3=0x0F; //0
			twatch (3 * Time);
			P3=0;
			twatch (2 * Time);
		}
		P3=0x00;
		twatch(10 * Time);
	}
}

pwm(40);

/*SIGNAL void pwm (unsigned long Time) { 
	//twatch(4*Time);
	//искусственная задержка для синхронизации
	//в реальном времени исполнения функции pwm( ) и основной программы
	
	while(1) {
	
		// формирование диаграммы, соответствующей  биту 
		//  P3.i = 1  ,  i=0..5  , S1=6
		
		P3 = 0;		 
		twatch (Time); 
		P3 = 0x3f;                 
		twatch (2*Time);
				 // формирование диаграммы, соответствующей  биту 
				 //  P3.i = 0,  S0=3
		P3 = 0;		
		twatch (2*Time);
		P3 = 0x3f;
		twatch (Time);
				   //S1=6
		P3 = 0;
		twatch (Time);         
		P3 = 0x3f;
		twatch (2*Time);

					//S0=3
		P3 = 0;
		twatch (2*Time);	       
		P3 = 0x3f;
		twatch (Time);

		P3=0;
		twatch(10*Time);
	}
}*/


/*SIGNAL void pwm (unsigned long Time) {
	while(1) {
		PORT3 = 0;
		twatch(Time); 
		PORT3 = 60;
		twatch(Time); 
	} 
}*/
